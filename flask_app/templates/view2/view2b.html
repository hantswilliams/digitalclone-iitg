{% extends "index.html" %}

{% block content %}

<div class="flex justify-center items-start pt-6 w-full">
    <div class="flex w-full -mx-2">
        <!-- Form Column -->
        <div class="px-2 w-2/5">
            <div class="bg-white shadow-md rounded px-8 pt-6 pb-8">
                <h2 class="mb-6 text-center text-2xl font-extrabold text-gray-900">Create A PowerPoint Slide (DEMO)</h2>
                <form action="/view4/submit" method="post">
                    <!-- Slide Title -->
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="slide-title">
                            Slide Title
                        </label>
                        <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" 
                            id="slide-title" 
                            name="slide_title" 
                            type="text" 
                            placeholder="Enter slide title"
                        >
                    </div>
    
                    <!-- Slide Body -->
                    <div class="mb-6">
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="slide-body">
                            Slide Body
                        </label>
                        <textarea class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 mb-3 leading-tight focus:outline-none focus:shadow-outline" 
                            id="slide-body" 
                            name="slide_body" 
                            placeholder="Enter slide content" 
                            rows="5">
                        </textarea>
                    </div>

                    <!-- Slide Audio Text-->
                    <div class="mb-6">
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="slide-audio-text">
                            Slide Audio Text
                        </label>
                        <textarea class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 mb-3 leading-tight focus:outline-none focus:shadow-outline" 
                            id="slide-audio-text" 
                            name="slide_audio_text" 
                            placeholder="Enter slide audio text" 
                            rows="5">
                        </textarea>
                    </div>

                    <!-- Select Audio Voice -->
                    <div class="mb-6">
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="audio-voice-select">
                            Audio Voice Select
                        </label>
                        <select name="voice" id="voice" class="shadow border rounded py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                            <option value="male_matt">Male (Matt)</option>
                            <option value="female_nichole">Female (Nicole)</option>
                            <option value="male_hants">Male (Hants)</option>
                         </select>
                    </div>
    
                    <!-- Image (Actor) Select -->
                    <div class="mb-6">
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="image-select">
                            Image (Actor) Select
                        </label>
                        <select class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 mb-3 leading-tight focus:outline-none focus:shadow-outline" 
                            id="image-select" 
                            name="image_select">
    
                            {% for row in photo_data %}
                                <option value="{{ row.photo_url }}">{{ row.photo_description }}</option>
                            {% endfor %}
                        </select>

                        <!-- Image Preview -->
                        <div id="selected-image-container" class="mb-4" hidden>
                            <label class="block text-gray-700 text-sm font-bold mb-2" hidden>Image Preview:</label>
                            <img id="selected-image" style="width: 200; height: 200;" hidden></img>
                        </div>

    
                    </div>
    
                    <!-- Submit Button -->
                    <div class="flex items-center justify-between">
                        <button class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline" type="submit">
                            Create Slide
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Slide Preview Column -->
        <div class="px-2 w-3/5">
            <div class="mt-8">
                <h3 class="text-lg font-semibold text-gray-900 mb-2">Slide Preview (estimate):</h3>
                <div id="slide-preview" class="border rounded-lg p-4 bg-white" style="min-height: 300px;">
                    <h4 id="preview-title" class="text-xl font-bold mb-4">[Slide Title]</h4>
                    <div class="flex">
                        <p id="preview-body" class="flex-grow text-gray-700 mr-4">[Slide Body]</p>
                        <div id="preview-image" class="w-1/3">
                            <img id="image-player" style="width: 200; height: 200;"></img>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

{% block scripts %}
    <script>

        // Function to update image preview
        function updateImagePreview() {
            var imageUrl = document.getElementById('image-select').value;
            var imageViewer = document.getElementById('selected-image');
            var imageContainer = document.getElementById('selected-image-container');
            imageViewer.src = imageUrl;
            imageContainer.hidden = false; // Show the container
        }

        // Update image preview when page loads
        updateImagePreview();

        function updateSlidePreview() {
            var title = document.getElementById('slide-title').value;
            var body = document.getElementById('slide-body').value;
            var imageUrl = document.getElementById('image-select').value;
            document.getElementById('preview-title').textContent = title || '[Slide Title]';

            // Replace newline characters with <br> tags for the slide preview
            var formattedBody = body.replace(/\n/g, '<br>');
            document.getElementById('preview-body').innerHTML = formattedBody || '[Slide Body]';

            var previewImage = document.getElementById('image-player'); // Reference to the image in the slide preview
            previewImage.src = imageUrl; // Set the selected image URL as the src for the preview image
        }

        // Event listeners for updating slide preview
        document.getElementById('slide-title').addEventListener('input', updateSlidePreview);
        document.getElementById('slide-body').addEventListener('input', updateSlidePreview);
        document.getElementById('image-select').addEventListener('change', updateSlidePreview); // Update preview on image change as well

        // Initialize previews
        updateSlidePreview();
        updateImagePreview();

    </script>
{% endblock %}

{% endblock %}
